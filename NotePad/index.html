
<!--https://sunil-chakraborty.github.io/sunil-c.github.io/NotePad/
https://tinyurl.com/mynPad
-->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Tab Notepad with Avro Bengali Typing</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    background: #f9f9f9;
    color: #333;
  }

  header {
    background: linear-gradient(135deg, #4a90e2, #0078d7);
    color: white;
    padding: 15px 20px;
    font-size: 1.5rem;
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  header .right-section {
    font-size: 0.95rem;
    margin-top: 5px;
  }

  .container {
    max-width: 900px;
    margin: 20px auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .tabs {
    display: flex;
    margin-bottom: 10px;
    flex-wrap: wrap;
  }

  .tab {
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-bottom: none;
    cursor: pointer;
    background: #f1f1f1;
    margin-right: 5px;
    border-radius: 6px 6px 0 0;
  }
  .tab.active { background: white; font-weight: bold; }

  textarea {
    width: 98%;
    height: 300px;
    padding: 5px;
    font-size: 15px;
    border: 1px solid #ccc;
    border-radius: 6px;
    resize: vertical;
  }

  .controls {
    margin-top: 15px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
  }
  .controls button {
    background: #4a90e2;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 14px;
    cursor: pointer;
    font-size: 14px;
  }
  .controls button:hover { background: #0078d7; }

  #cheatSheet {
    margin-top: 20px;
    padding: 15px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background: #fefefe;
    font-size: 14px;
    line-height: 1.5;
    display: none;
    max-height: 400px;
    overflow-y: auto;
  }
  #cheatSheet h3 { margin-top: 0; color: #0078d7; }
  #cheatSheet table { border-collapse: collapse; width: 100%; margin-bottom: 10px; }
  #cheatSheet th, #cheatSheet td {
    border: 1px solid #ddd;
    padding: 6px 8px;
    text-align: center;
  }
  #cheatSheet th { background: #f1f1f1; }
</style>
</head>
<body>

<header>
  <div>üìù Multi-Tab Notepad</div>
  <div class="right-section">
    <span id="date"></span>
	<p id="quote" style="font-style:italic;"></p>
  </div>
</header>

<div class="container">
  <div class="tabs" id="tabContainer"></div>
  <textarea id="noteArea" placeholder="Start typing your notes here..."></textarea>

  <div class="controls">
    <button onclick="newTab()">‚ûï New Tab</button>
    <button onclick="renameTab()">‚úèÔ∏è Rename Tab</button>
    <button onclick="saveToFile()">üíæ Save to File</button>
	<button onclick="shareSelectedText()">üì§ Share Selected Text</button>
    <button id="avroToggle" onclick="toggleAvro()">üÖ±Ô∏è Bengali ON</button>
    <button onclick="toggleCheatSheet()">üìñ Cheat Sheet</button>
	<button onclick="toggleCalender()">üìñ Bengali Calender</button>
  </div>
  <div id="cheatSheet" style="display:none; margin-top:20px; height:500px;">
	  <iframe src="cheat_sheet.pdf" width="100%" height="100%" style="border:none;"></iframe>
  </div> 
  <div id="banglaCalender" style="display:none; margin-top:20px; height:500px;">
	  <iframe src="bengali-calendar-1432.pdf" width="100%" height="100%" style="border:none;"></iframe>
  </div> 
</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Avro JS -->
<script src="js/avro-v1.1.4.min.js"></script>

<script>
  // Date
  function updateDate() {
    const now = new Date();
    const day = String(now.getDate()).padStart(2, '0');
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const year = String(now.getFullYear()).slice(-2);
    const time = now.toLocaleTimeString();
    const weekday = now.toLocaleDateString('en-US', { weekday: 'long' }); 
    document.getElementById("date").textContent = `${weekday} ${day}-${month}-${year} ${time}`;
  }
  setInterval(updateDate, 1000);
  updateDate();

  // Quotes
  const quotes = [
    "Start where you are. Use what you have. Do what you can.",
    "‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶Ø‡¶§‡¶á ‡¶ï‡¶†‡¶ø‡¶® ‡¶π‡ßã‡¶ï, ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶ì‡•§",
    "Small steps every day lead to big results.",
    "Dream big. Work hard. Stay humble.",
    "‡¶∏‡¶æ‡¶π‡¶∏‡ßÄ‡¶∞‡¶æ ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡¶• ‡¶®‡¶ø‡¶ú‡ßá‡¶∞‡¶æ‡¶á ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßá‡•§"
  ];
  document.getElementById("quote").textContent = quotes[Math.floor(Math.random()*quotes.length)];

  // Cheat Sheet toggle
  function toggleCheatSheet() {
    const sheet = document.getElementById("cheatSheet");
    sheet.style.display = (sheet.style.display === "none" || sheet.style.display === "") 
      ? "block" : "none";
  }

  // Calender toggle
  function toggleCalender() {
    const sheet = document.getElementById("banglaCalender");
    sheet.style.display = (sheet.style.display === "none" || sheet.style.display === "") 
      ? "block" : "none";
  }

  // Avro toggle using clone+rebind
  let avroEnabled = true;
  $(document).ready(function(){
    $("#noteArea").avro(); // enable Avro by default
    enableAvroMobilePatch(); // also activate mobile patch
  });

  function toggleAvro() {
    const oldArea = document.getElementById("noteArea");

    if (avroEnabled) {
      // Disable Avro ‚Üí clone without bindings
      const clone = oldArea.cloneNode(true);
      clone.value = oldArea.value;
      oldArea.parentNode.replaceChild(clone, oldArea);

      avroEnabled = false;
      document.getElementById("avroToggle").textContent = "üî§ English ON";
    } else {
      // Enable Avro ‚Üí rebind Avro on fresh clone
      const fresh = document.getElementById("noteArea");
      $(fresh).avro();
      enableAvroMobilePatch(); // reapply mobile patch
      avroEnabled = true;
      document.getElementById("avroToggle").textContent = "üÖ±Ô∏è Bengali ON";
    }
  }

  // Hotkey Ctrl + M
  document.addEventListener("keydown", function(e) {
    if (e.ctrlKey && e.key === "m") {
      e.preventDefault();
      toggleAvro();
    }
  });

  // Mobile patch: use input/composition events
  function enableAvroMobilePatch() {
	  const area = document.getElementById("noteArea");
	
	  area.addEventListener("input", function(e) {
	    if (!avroEnabled) return;
	
	    const pos = area.selectionStart;
	    const before = area.value.substring(0, pos);
	    const after = area.value.substring(pos);
	
	    // Run Avro transliteration but preserve the latest typed char
	    const lastChar = before.slice(-1);
	    const base = before.slice(0, -1);
	    const converted = Avro.Phonetic.parse(base) + lastChar;
	
	    area.value = converted + after;
	    const newPos = converted.length;
	    area.selectionStart = area.selectionEnd = newPos;
	  });
	
	  area.addEventListener("compositionend", function() {
	    if (!avroEnabled) return;
	
	    const pos = area.selectionStart;
	    const before = area.value.substring(0, pos);
	    const after = area.value.substring(pos);
	
	    const converted = Avro.Phonetic.parse(before);
	    area.value = converted + after;
	    area.selectionStart = area.selectionEnd = converted.length;
	  });
	}


  // Dummy tab functions
  function newTab(){alert("New Tab");}
  function renameTab(){alert("Rename Tab");}
  function saveToFile(){alert("Save File");}
</script>

<!-- Your Notepad core -->
<script src="js/notepad.js"></script>

</body>
</html>
